# FLOORPLAN VIEW
title: "Floorplan control"
path: "floorplan"
type: sidebar
theme: ios-dark-mode
background: center / cover no-repeat url("/local/ui/bg-gradient3.png") fixed
cards:
  # SIDEBAR CONTENTS
  - type: vertical-stack
    view_layout:
      position: sidebar
    cards:
    # Display Clock
    - type: custom:button-card
      entity: sensor.time
      template: navbar_clock
    # Display Date string
    - type: custom:button-card
      entity: sensor.date_string
      template: navbar_datestring
    # NAVBUTTONS
    # Dashboard
    - type: custom:button-card
      template: navbar_button
      name: Dashboard
      icon: mdi:home
      tap_action:
        action: navigate
        navigation_path: /dashboard-tablet/dashboard
    # Floorplan control
    - type: custom:button-card
      template: navbar_button
      name: Floorplan control
      icon: mdi:floor-plan
      variables:
        link_active: "true"
      tap_action:
        action: navigate
        navigation_path: /dashboard-tablet/floorplan
    # Sleep
    - type: custom:button-card
      template: navbar_button
      name: Bedtime & wake-up
      icon: mdi:bed
      tap_action:
        action: navigate
        navigation_path: /dashboard-tablet/sleep
    # Consumption
    - type: custom:button-card
      icon: mdi:lightning-bolt
      name: Energy
      template: navbar_button
      tap_action:
        action: navigate
        navigation_path: /dashboard-tablet/consumption
    # Special
    - type: custom:button-card
      icon: mdi:information-slab-circle
      name: Guest info
      template: navbar_button
      tap_action:
        action: navigate
        navigation_path: /dashboard-tablet/guests
    # Listen
    - type: custom:button-card
      icon: mdi:speaker
      name: Listen
      template: navbar_button
      tap_action:
        action: navigate
        navigation_path: /dashboard-tablet/audio
    # VERTICAL SPACER ELEMENT: ADJUST THE HEIGHT AS NEEDED
    - type: custom:button-card
      color_type: blank_card
      styles:
        card:
          - height: 25vh
          - background-color: transparent
    # Bottom chips
    - type: custom:mushroom-chips-card
      alignment: center
      card_mod:
        style: |
          ha-card {
            --chip-background: transparent;
            --primary-text-color: var(--secondary-text-color);
          }
      chips:
      - type: action
        tap_action:
          action: navigate
          navigation_path: /lovelace/0
        icon: mdi:cog
      - type: entity
        entity: sensor.temperature_apartment_avg
      - type: weather
        entity: weather.yr_weather_home
        show_temperature: true
        show_conditions: true

  # MAIN SECTION CONTENTS    
  - type: horizontal-stack
    cards:
    # ###################################################################
    #
    # ROOM INFO & CONTROL COLUMN
    #
    # ###################################################################
    - type: custom:mod-card
      card_mod:
        # Add 5% padding on both sides of the info section
        # 3% on right side since the 3D-floorplan has inherit 2% l-padding
        style: |
          ha-card {
            padding-left: 5vw;
            padding-right: 3vw;
          }
      card:
        # #################################################################
        # SELECTED ROOM STATE-SWITCH HANDLER
        # Shows room-info based on which room is selected
        # Each room is handled under their respective string under 'states'
        type: custom:state-switch
        entity: input_select.floorplan_select_state
        default: 'none'
        # All of the different selected room-options, that are 
        # defined as choosable options in the input_select-helper:
        # - none (default Home-view)
        # - bath
        # - bedroom
        # - entry
        # - guest
        # - kitchen
        # - living
        # - office
        # - storage
        # - toilet
        # - veranda
        states:
          # ###############################################################
          # HOME VIEW ("NONE" SELECTED)
          none:
            type: vertical-stack
            cards:
            # HOME-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Gullburet Home
            # HOME-VIEW: ALL LIGHTS
            - type: custom:stack-in-card
              mode: vertical
              cards:
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  margin: 0px
                  grid-gap: "0px 4px"
                  padding: 4px 0px 12px 12px
                  grid-template-areas: '"title . auto num brightness"'
                  grid-template-rows: min-content
                  grid-template-columns: 1fr max-content max-content max-content
                cards:
                - type: custom:button-card
                  template: section_title
                  name: All lights
                - type: custom:button-card
                  template: text_chip
                  icon: mdi:brightness-auto
                  entity: input_boolean.auto_suncycle_masterdim
                  tap_action:
                    action: toggle
                  variables:
                    iconColor: '#1ac8ed'
                - type: custom:button-card
                  template: text_chip
                  icon: mdi:ceiling-light-multiple
                  entity: sensor.lights_on_count
                  tap_action:
                    action: none
                - type: custom:button-card
                  template: text_chip
                  icon: mdi:brightness-7
                  entity: input_number.apartment_dimmer
                  numeric_precision: 0
                  tap_action:
                    action: none
                  variables:
                    iconColor: '#ff9800'
              - type: conditional
                conditions:
                - condition: state
                  entity: input_boolean.auto_suncycle_masterdim
                  state: "on"
                card:
                  type: custom:mushroom-entity-card
                  entity: input_text.sun_cycle_next_event
                  primary_info: state
                  secondary_info: name
                  icon_color: primary
                  name: Next automatic dim event
                  icon: mdi:brightness-auto
                  tap_action:
                    action: call-service
                    service: input_boolean.toggle
                    target:
                      entity_id: input_boolean.auto_suncycle_masterdim
                  icon_tap_action:
                    action: call-service
                    service: input_boolean.toggle
                    target:
                      entity_id: input_boolean.auto_suncycle_masterdim
                  card_mod:
                    style: |
                      ha-card {
                        background-color: var(--nested-card-background);
                        font-family: var(--primary-font-family) !important;
                      }
              - type: conditional
                conditions:
                - condition: state
                  entity: input_boolean.auto_suncycle_masterdim
                  state: "off"
                card:
                  type: custom:mushroom-entity-card
                  entity: input_boolean.auto_suncycle_masterdim
                  primary_info: state
                  secondary_info: name
                  icon_color: primary
                  name: Next automatic dim event
                  icon: mdi:brightness-auto
                  tap_action:
                    action: call-service
                    service: input_boolean.toggle
                    target:
                      entity_id: input_boolean.auto_suncycle_masterdim
                  icon_tap_action:
                    action: call-service
                    service: input_boolean.toggle
                    target:
                      entity_id: input_boolean.auto_suncycle_masterdim
                  card_mod:
                    style: |
                      ha-card {
                        background-color: var(--nested-card-background);
                        font-family: var(--primary-font-family) !important;
                      }
              - type: custom:layout-card
                layout_type: grid
                layout:
                  grid-gap: "var(--ha-card-padding) var(--ha-card-padding)"
                  grid-template-columns: 1fr 1fr 1fr
                  margin: 0px
                  padding: 4px var(--ha-card-padding) 4px 
                cards:
                # 1st row
                - type: "custom:button-card"
                  icon: mdi:lightbulb-group
                  name: "Turn ON"
                  template: light_mode
                  entity: script.all_lights_on
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    data:
                      entity_id: script.all_lights_on
                - type: "custom:button-card"
                  icon: mdi:lightbulb-group-off-outline
                  name: "Turn OFF"
                  entity: script.all_lights_off
                  template: light_mode
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    data:
                      entity_id: script.all_lights_off
                - type: "custom:button-card"
                  icon: mdi:bed
                  name: Bedtime
                  template: light_mode
                  entity: script.bedtime_lights
                  tap_action:
                    action: call-service
                    service: script.turn_on
                    data:
                      entity_id: script.bedtime_lights
                # 2nd row
                - type: "custom:button-card"
                  icon: mdi:silverware-variant
                  name: "Dinner"
                  template: light_mode_toggle
                  entity: input_boolean.lights_dining_mode
                - type: "custom:button-card"
                  icon: mdi:pot-steam
                  name: "Cooking"
                  template: light_mode_toggle
                  entity: input_boolean.lights_cooking_mode
                - type: "custom:button-card"
                  icon: mdi:video-vintage
                  name: "Movie"
                  template: light_mode_toggle
                  entity: input_boolean.lights_movie_mode
              - type: custom:mushroom-number-card
                entity: input_number.apartment_dimmer
                layout: horizontal
                icon_color: accent
                icon_type: none
                primary_info: none
                secondary_info: none
                card_mod:
                  style:
                    mushroom-number-value-control$: |
                      mushroom-slider {
                        --main-color: var(--color-accent) !important;
                        --bg-color: var(--button-card-background) !important;
                      }
                    mushroom-fan-percentage-control$:
                      mushroom-slider$: |
                        .slider {
                          border-radius: 8px !important;
                        }
                    .: |
                      ha-card {
                        padding: 4px var(--ha-card-padding) var(--ha-card-padding) !important;
                      }
                  # background-color: var(--nested-card-background);
            # HOME-VIEW: CLEANING
            - type: custom:stack-in-card
              mode: vertical
              cards:
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  margin: 0px
                  grid-gap: "0px 4px"
                  padding: 4px 0px 12px 12px
                  grid-template-areas: '"title . fan mop"'
                  grid-template-rows: min-content
                  grid-template-columns: 1fr max-content max-content
                cards:
                - type: custom:button-card
                  template: section_title
                  name: Cleaning
                - type: custom:button-card
                  template: text_chip
                  icon: mdi:fan
                  entity: sensor.esmeralda_fan_speed
                  tap_action:
                    action: none
                - type: custom:button-card
                  template: text_chip
                  icon: mdi:water
                  state_display: |
                    [[[
                      var mop = states['binary_sensor.esmeralda_mop_attached'].state
                      var box = states['binary_sensor.esmeralda_water_box_attached'].state

                      if (mop == "off") return "Mop removed";
                      if (box == "off") return "Tank removed";
                      return "Mop ready";
                    ]]]
                  tap_action:
                    action: none
              - type: custom:mushroom-vacuum-card
                entity: vacuum.esmeralda
                icon_animation: true
                icon_color: accent
                commands:
                  - start_pause
                  - stop
                  - return_home
                layout: horizontal
                card_mod:
                  style: |
                    ha-card {
                      background-color: var(--nested-card-background);
                      font-family: var(--primary-font-family) !important;
                    }
              - type: custom:layout-card
                layout_type: grid
                layout:
                  grid-gap: "0px var(--ha-card-padding)"
                  grid-template-columns: 1fr 1fr
                  margin: 0px
                  padding: 2px var(--ha-card-padding) 2px
                cards:
                - type: custom:button-card
                  template: light_mode_toggle
                  entity: input_boolean.select_rooms_cleaning
                  name: Select rooms
                - type: conditional
                  conditions:
                  - type: state
                    entity: input_boolean.select_rooms_cleaning
                    state_not: "on"
                  card:
                    type: custom:button-card
                    color_type: blank
                    styles:
                      card:
                      - background: transparent
                - type: conditional
                  conditions:
                  - type: state
                    entity: input_boolean.select_rooms_cleaning
                    state: "on"
                  card:
                    type: custom:button-card
                    template: light_mode
                    icon: mdi:play
                    name: Clean selected rooms
                    tap_action:
                      action: call-service
                      service: script.clean_selected_rooms
              - type: conditional
                conditions:
                  - type: state
                    entity: binary_sensor.esmeralda_mop_ready
                    state_not: "on"
                card:
                  type: custom:layout-card
                  layout_type: grid
                  layout:
                    grid-gap: "0px var(--ha-card-padding)"
                    grid-template-columns: 1fr 1fr 1fr 1fr
                    margin: 0px
                    padding: 2px var(--ha-card-padding) var(--ha-card-padding)
                  cards:
                  - type: custom:button-card
                    entity: vacuum.esmeralda
                    icon: mdi:power-sleep
                    template: vacuum_fan_speed
                    variables:
                      fan_speed: "Silent"
                  - type: custom:button-card
                    icon: mdi:fan
                    entity: vacuum.esmeralda
                    template: vacuum_fan_speed
                    variables:
                      fan_speed: "Standard"
                  - type: custom:button-card
                    icon: mdi:fan-plus
                    entity: vacuum.esmeralda
                    template: vacuum_fan_speed
                    variables:
                      fan_speed: "Medium"
                  - type: custom:button-card
                    icon: mdi:fan-speed-3
                    entity: vacuum.esmeralda
                    template: vacuum_fan_speed
                    variables:
                      fan_speed: "Turbo"
              - type: conditional
                conditions:
                - type: state
                  entity: binary_sensor.esmeralda_mop_ready
                  state: "on"
                card:
                  type: "custom:layout-card"
                  layout_type: grid
                  layout:
                    grid-gap: "0px var(--ha-card-padding)"
                    grid-template-columns: 1fr 1fr 1fr 1fr
                    margin: 0px
                    padding: 2px var(--ha-card-padding) var(--ha-card-padding)
                  cards:
                  - type: custom:button-card
                    entity: script.robot_set_mop_mode
                    icon: mdi:power-sleep
                    template: vacuum_mopping
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      data:
                        entity_id: script.robot_set_mop_mode
                        variables:
                          mopping_mode: Low
                          fan_speed: Silent
                  - type: custom:button-card
                    entity: script.robot_set_mop_mode
                    icon: mdi:fan
                    template: vacuum_mopping
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      data:
                        entity_id: script.robot_set_mop_mode
                        variables:
                          mopping_mode: Medium
                          fan_speed: Standard
                  - type: "custom:button-card"
                    icon: mdi:water
                    name: "Only"
                    entity: script.robot_set_mop_mode
                    template: light_mode
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      data:
                        entity_id: script.robot_set_mop_mode
                        variables:
                          mopping_mode: Medium
                          mopping_route: Deep
                  - type: "custom:button-card"
                    icon: mdi:creation
                    name: "Deep+"
                    entity: script.robot_set_mop_mode
                    template: light_mode
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      data:
                        entity_id: script.robot_set_mop_mode
                        variables:
                          mopping_mode: High
                          mopping_route: DeepPlus
              # AUDIO
              #- type: custom:stack-in-card
              #  mode: vertical
              #  cards:
              #  - type: custom:mushroom-media-player-card
              #    entity: media_player.sonos_living
              #    layout: horizontal
              #    name: Common-rooms
              #    volume_controls:
              #      - volume_set
              #    media_controls:
              #      - previous
              #      - next
              #      - play_pause_stop
              #    icon_type: icon
              #    primary_info: name
              #    card_mod:
              #      style: |
              #        ha-card {
              #          background-color: var(--nested-card-background);
              #        }
              #  - type: "custom:layout-card"
              #    layout_type: grid
              #    layout:
              #      grid-gap: "0px var(--ha-card-padding)"
              #      grid-template-columns: 1fr 1fr
              #      margin: 0px
              #      padding: var(--ha-card-padding)
              #    cards:
              #    - type: "custom:button-card"
              #      icon: mdi:speaker-multiple
              #      name: "Group"
              #      entity: script.speakers_join_all
              #      template: light_mode
              #      tap_action:
              #        action: call-service
              #        service: script.turn_on
              #        data:
              #          entity_id: script.speakers_join_all
              #    - type: "custom:button-card"
              #      icon: mdi:speaker
              #      name: "Ungroup"
              #      entity: script.speakers_unjoin_all
              #      template: light_mode
              #      tap_action:
              #        action: call-service
              #        service: script.turn_on
              #        data:
              #          entity_id: script.speakers_unjoin_all     
          # ###############################################################
          # BATHROOM VIEW
          bath:
            type: vertical-stack
            cards:
            # BATH-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Bathroom
            # BATH-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_bath
                - humidity_entity: sensor.humidity_placeholder
                - mode_entity: input_select.heating_mode_bath
                - climate_entity: climate.floor_heat_bath
            # BATH-VIEW: LIGHT MODES
            - type: custom:stack-in-card
              mode: vertical
              cards:
              - type: custom:button-card
                template: section_title
                name: Light modes
                styles:
                  card:
                  - padding: 8px var(--ha-card-padding) 16px
                  - height: 48px 
              - type: custom:layout-card
                layout_type: grid
                layout:
                  grid-gap: "0px var(--ha-card-padding)"
                  grid-template-columns: 1fr 1fr 1fr
                  margin: 0px
                  padding: 4px var(--ha-card-padding) var(--ha-card-padding)
                cards:
                - type: custom:button-card
                  entity: input_select.bathroom_mode_select
                  icon: mdi:brightness-7
                  name: Bright
                  template: input_select_buttons
                  variables:
                    select_option: "bright"
                - type: custom:button-card
                  entity: input_select.bathroom_mode_select
                  icon: mdi:power-sleep
                  name: Night
                  template: input_select_buttons
                  variables:
                    select_option: "night"
                - type: custom:button-card
                  entity: input_select.bathroom_mode_select
                  icon: mdi:spa
                  name: Spa
                  template: input_select_buttons
                  variables:
                    select_option: "spa"
          # ###############################################################
          # BEDROOM VIEW
          bedroom: 
            type: vertical-stack
            cards:
            # BEDROOM-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Bedroom
            # BEDROOM-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_bedroom
                - humidity_entity: sensor.humidity_bedroom
                - mode_entity: input_select.heating_mode_bedroom
                - climate_entity: climate.heater_bedroom
            # BEDROOM-VIEW: DEVICES
            - type: custom:stack-in-card
              mode: vertical
              cards:
              - type: custom:button-card
                template: section_title
                name: Devices
                styles:
                  card:
                  - padding: 8px var(--ha-card-padding) 16px
                  - height: 48px
              - type: horizontal-stack
                cards:
                - type: custom:mushroom-light-card
                  entity: light.lightstrip_closet_bedroom
                  name: Wardrobe light
                  icon: mdi:hanger
                  icon_color: white
                  card_mod:
                    style: |
                      ha-card {
                        padding: 4px var(--ha-card-padding) 4px !important;
                      }
                - type: custom:mushroom-light-card
                  entity: light.pendant_bedroom
                  icon: mdi:ceiling-light
                  icon_color: white
                  name: Pendant lamp
                  card_mod:
                    style: |
                      ha-card {
                        padding: 4px var(--ha-card-padding) 4px !important;
                      }
              - type: custom:timer-bar-card
                entity: timer.heated_sheet_timer
                name: "Heated sheet timer"
                invert: true
                bar_direction: rtl
                mushroom:
                  layout: horizontal
                  color: deep-orange
                card_mod:
                  style: |
                    ha-card {
                      background-color: var(--nested-card-background);
                      padding: 4px var(--ha-card-padding) 4px !important;
                    }
              - type: horizontal-stack
                cards:
                - type: custom:mushroom-entity-card
                  entity: script.bedroom_heated_sheet_control
                  icon: mdi:chevron-up
                  icon_color: white
                  name: Timer +30min
                  secondary_info: none
                  tap_action:
                    action: call-service
                    service: script.bedroom_heated_sheet_control
                    data:
                      command: up
                      increase: 00:30:00
                  card_mod:
                    style: |
                      ha-card {
                        padding: 4px var(--ha-card-padding) var(--ha-card-padding) !important;
                      }
                - type: custom:mushroom-entity-card
                  entity: script.bedroom_heated_sheet_control
                  icon: mdi:chevron-down
                  icon_color: white
                  name: Timer -10min
                  secondary_info: none
                  tap_action:
                    action: call-service
                    service: script.bedroom_heated_sheet_control
                    data:
                      command: down
                      decrease: 00:10:00
                  card_mod:
                    style: |
                      ha-card {
                        padding: 4px var(--ha-card-padding) var(--ha-card-padding) !important;
                      }
            # BEDROOM-VIEW: CLEANING
            # Bedroom Xiaomi id = 20
            - type: custom:decluttering-card
              template: cleaning_section
              variables: 
                - xiaomi_room_id: 20
          # ###############################################################
          # ENTRY VIEW
          entry:
            type: vertical-stack
            cards:
            # ENTRY-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Entry hall
            # ENTRY-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section_wo_thermo
              variables:
                - temperature_entity: sensor.temperature_entry
                - humidity_entity: sensor.humidity_entry
            # ENTRY-VIEW: CLEANING
            # Entry Xiaomi id = 16
            - type: custom:decluttering-card
              template: cleaning_section
              variables: 
                - xiaomi_room_id: 16
          # ###############################################################
          # GUEST VIEW
          guest:
            type: vertical-stack
            cards:
            # GUEST-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Guest room
            # GUEST-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_guest
                - humidity_entity: sensor.humidity_guest
                - mode_entity: input_select.heating_mode_guest
                - climate_entity: climate.heater_guest
            # GUEST-VIEW: CLEANING
            # Guest room Xiaomi id = 19
            - type: custom:decluttering-card
              template: cleaning_section
              variables: 
                - xiaomi_room_id: 19
          # ###############################################################
          # KITCHEN VIEW
          kitchen:
            type: vertical-stack
            cards:
            # KITCHEN-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Kitchen
            # KITCHEN-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_kitchen
                - humidity_entity: sensor.humidity_kitchen
                - mode_entity: input_select.heating_mode_kitchen
                - climate_entity: climate.heater_kitchen
            # KITCHEN-VIEW: CLEANING
            # Kitchen Xiaomi id = 17
            - type: custom:decluttering-card
              template: cleaning_section
              variables: 
                - xiaomi_room_id: 17
          # ###############################################################
          # LIVING VIEW
          living:
            type: vertical-stack
            cards:
            # LIVING-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Living room
            # LIVING-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_living
                - humidity_entity: sensor.humidity_living
                - mode_entity: input_select.heating_mode_living
                - climate_entity: climate.heater_living
            # CLEANING SECTION
            # Living room Xiaomi id = 18
            - type: custom:decluttering-card
              template: cleaning_section
              variables: 
                - xiaomi_room_id: 18
          # ###############################################################
          # OFFICE VIEW
          office:
            type: vertical-stack
            cards:
            # OFFICE-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Office
            # OFFICE-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_office
                - humidity_entity: sensor.humidity_office
                - mode_entity: input_select.heating_mode_office
                - climate_entity: climate.heater_office
            # OFFICE-VIEW: CLEANING
            # Office Xiaomi id = 21
            - type: custom:decluttering-card
              template: cleaning_section
              variables: 
                - xiaomi_room_id: 21
          # ###############################################################
          # STORAGE VIEW
          storage:
            type: vertical-stack
            cards:
            # STORAGE-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Storage
            # STORAGE-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section_wo_thermo
              variables:
                - temperature_entity: sensor.temperature_storage
                - humidity_entity: sensor.humidity_placeholder
            # STORAGE-VIEW: LIGHTS
            - type: custom:stack-in-card
              mode: vertical
              cards:
              - type: custom:button-card
                template: section_title
                name: Lights
                styles:
                  card:
                  - padding: 8px var(--ha-card-padding) 16px
                  - height: 48px
              - type: custom:timer-bar-card
                entity: timer.storage_room_light_timer
                name: "Light timer"
                invert: true
                bar_direction: rtl
                mushroom:
                  layout: horizontal
                  color: white
                card_mod:
                  style: |
                    ha-card {
                      background-color: var(--nested-card-background);
                    }
              - type: tile
                entity: script.storage_room_finish_timer
                hide_state: true
                name: Turn off
                vertical: false
                color: white
                tap_action:
                  action: call-service
                  service: script.turn_on
                  target:
                    entity_id: script.storage_room_finish_timer
                icon_tap_action:
                  action: call-service
                  service: script.turn_on
                  target:
                    entity_id: script.storage_room_finish_timer                  
          # ###############################################################
          # TOILET ROOM VIEW
          toilet:
            type: vertical-stack
            cards:
            # TOILET-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Toilet room
            # TOILET-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section
              variables: 
                - temperature_entity: sensor.temperature_toilet
                - humidity_entity: sensor.humidity_placeholder
                - mode_entity: input_select.heating_mode_toilet
                - climate_entity: climate.floor_heat_toilet
          # ###############################################################
          # VERANDA VIEW
          veranda:
            type: vertical-stack
            cards:
            # VERANDA-VIEW: TITLE
            - type: custom:button-card
              template: room_title
              name: Veranda
            # VERANDA-VIEW: CLIMATE
            - type: custom:decluttering-card
              template: climate_section_wo_thermo
              variables:
                - temperature_entity: sensor.temperature_outdoor
                - humidity_entity: sensor.humidity_outdoor
            # VERANDA-VIEW: LIGHTS
            - type: custom:stack-in-card
              mode: vertical
              cards:
              - type: custom:button-card
                template: section_title
                name: Lights
                styles:
                  card:
                  - padding: 8px var(--ha-card-padding) 16px
                  - height: 48px
              - type: horizontal-stack
                cards:
                - type: tile
                  entity: switch.string_lights_veranda
                  icon: mdi:string-lights
                  name: String lights
                  color: white
                - type: tile
                  entity: light.wall_light_veranda
                  icon: mdi:coach-lamp
                  name: Wall lantern
                  color: white                   
    # ------------------------------------------------- END OF ROOM INFOS
    
    # ###################################################################
    #
    # 3D FLOORPLAN VISUALIZATION COLUMN
    #
    # Automatic Z-index layering: The closer the element is declared from
    #   the "elements:"-keyword, the lower its assigned Z-index. 
    #   I.e. the further down in the "elements"-sequence they are defined
    #   the higher ("in front") they are represented in the image-stack. 
    # ###################################################################
    - type: picture-elements
      # DARK, BASE-LAYER OF FLOORPLAN:
      image: /local/floorplan/base-dark-v3.png
      card_mod:
        style: |
          ha-card {
            width: 102%;
            background-color: transparent;
          }
      elements:    
        # ###########################################################
        # LIGHT EFFECT LAYERS
        # Purely visual effects - not interactable. Only illustrates
        #   state of lights with pre-rendered images.
        # Veranda
        - type: image
          entity: sensor.wall_lantern_veranda_dim
          image: "/local/floorplan/common-veranda.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Bedroom
        - type: image
          entity: sensor.pendant_bedroom_dim
          image: "/local/floorplan/bedroom-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Office
        - type: image
          entity: sensor.pendants_office_dim
          image: "/local/floorplan/office-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Guest
        - type: image
          entity: sensor.pendant_guest_dim
          image: "/local/floorplan/guest-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Toilet
        - type: image
          entity: sensor.downlight_toilet_dim
          image: "/local/floorplan/toilet-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Bathroom lightstrip
        - type: image
          entity: sensor.lightstrip_bath_dim
          image: "/local/floorplan/bath-lightstrip-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Bathroom downlights
        - type: image
          entity: sensor.downlights_bath_dim
          image: "/local/floorplan/bath-downlights-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%) 
        # Entry 
        - type: image
          entity: sensor.downlights_entry_dim
          image: "/local/floorplan/common-entry-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Living room spottrack
        - type: image
          entity: sensor.spottrack_living_dim
          image: "/local/floorplan/common-4track-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Living room downlights
        - type: image
          entity: sensor.downlights_living_dim
          image: "/local/floorplan/common-downlights-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Dining pendants
        - type: image
          entity: sensor.pendants_dining_dim
          image: "/local/floorplan/common-dining-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Kitchen pendants
        - type: image
          entity: sensor.pendants_kitchen_dim
          image: "/local/floorplan/common-flowerpots-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Kitchen spottrack
        - type: image
          entity: sensor.spottrack_kitchen_dim
          image: "/local/floorplan/common-6track-v2.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Kitchen lightstrip
        - type: image
          entity: sensor.lightstrip_undershelf_kitchen_dim
          image: "/local/floorplan/common-shelfstrip.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)
        # Storage room
        - type: image
          entity: sensor.ceiling_light_storage_dim
          image: "/local/floorplan/storage.png"
          style:
            left: 50%
            top: 50%
            width: 100%
            mix-blend-mode: lighten
          state_filter:
            "0": opacity(0%)
            "5": opacity(30%)
            "10": opacity(40%)
            "20": opacity(50%)
            "30": opacity(60%)
            "50": opacity(70%)
            "75": opacity(85%)
            "100": opacity(100%)

        # #####################################################################
        # OTHER 3D EFFECTS LAYERS
        # Living room curtains
        - type: custom:button-card
          entity: cover.curtain_living
          show_name: false
          show_icon: false
          custom_fields:
            curtains: |
              [[[
                let state = (entity.attributes.position / 100) * 75 + 25;
                
                return `
                <div style="overflow: visible;">
                  <img  src="/local/floorplan/curtains-rotated.png" 
                        style="height: 74px; width:${state}%; float: left; display: block; 
                        transform: perspective(350px) rotateX(140deg) skewX(-10deg) scaleY(1.1); 
                        margin-left: 14px">
                  </img>
                </div>
                `
              ]]]
          # scaleY(1.1);
          styles:
            card:
              - background: transparent
              - padding: 0px
              - height: 74px
              - width: 190px
              - border: none
              - margin: 0px
              - border-radius: 0px
            custom_fields:
              curtains:
                - border-radius: 0px
                - background: transparent
                - opacity: 90%
                - filter: brightness(70%) sepia(20%)
          style:
            left: 32%
            top: 13% 
          tap_action:
            action: none

        # #####################################################################
        # SELECT MULT. ROOMS CLEANING: CLICKABLE ZONES, OUTLINES & OVERLAYS
        - type: conditional
          conditions:
            - entity: input_boolean.select_rooms_cleaning
              state: "on"
          elements:
          # SELECTED ROOM OVERLAYS AND OUTLINES
          # BEDROOM
          - type: image
            entity: input_boolean.floorplan_bedroom_selected
            image: "/local/floorplan/outline-v2-bedroom.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
            tap_action:
              action: none
            hold_action:
              action: none
          - type: image
            entity: input_boolean.floorplan_bedroom_selected
            image: "/local/floorplan/overlay-bedroom.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none
          # ENTRY
          - type: image
            entity: input_boolean.floorplan_entry_selected
            image: "/local/floorplan/outline-v2-entry.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
            tap_action:
              action: none
            hold_action:
              action: none
          - type: image
            entity: input_boolean.floorplan_entry_selected
            image: "/local/floorplan/overlay-entry.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none
          # GUEST
          - type: image
            entity: input_boolean.floorplan_guest_selected
            image: "/local/floorplan/outline-v2-guest.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
            tap_action:
              action: none
            hold_action:
              action: none
          - type: image
            entity: input_boolean.floorplan_guest_selected
            image: "/local/floorplan/overlay-guest.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none
          # KITCHEN
          - type: image
            entity: input_boolean.floorplan_kitchen_selected
            image: "/local/floorplan/outline-v2-kitchen.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
            tap_action:
              action: none
            hold_action:
              action: none
          - type: image
            entity: input_boolean.floorplan_kitchen_selected
            image: "/local/floorplan/overlay-kitchen.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none
          # LIVING
          - type: image
            entity: input_boolean.floorplan_living_selected
            image: "/local/floorplan/outline-v2-living.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
            tap_action:
              action: none
            hold_action:
              action: none
          - type: image
            entity: input_boolean.floorplan_living_selected
            image: "/local/floorplan/overlay-living2.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none
          # OFFICE
          - type: image
            entity: input_boolean.floorplan_office_selected
            image: "/local/floorplan/outline-v2-office.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
            tap_action:
              action: none
            hold_action:
              action: none
          - type: image
            entity: input_boolean.floorplan_office_selected
            image: "/local/floorplan/overlay-office.png"
            state_filter:
              "on": hue-rotate(199deg)
              "off": hue-rotate(93deg)
            style:
              left: 50%
              top: 50%
              width: 100%
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none       
          # HIDDEN, CLICKABLE ZONES AS ICONS - Handles selecting
          # Entry
          - type: icon
            icon: mdi:selection
            entity: input_boolean.floorplan_entry_selected
            tap_action:
              action: toggle
            style:
              left: 61%
              top: 57%
              opacity: 0
              '--mdc-icon-size': 120px
              transform: 'scaleX(1.6) scaleY(1)'
          # Bedroom
          - type: icon
            icon: mdi:selection
            entity: input_boolean.floorplan_bedroom_selected
            tap_action:
              action: toggle
            style:
              left: 2%
              top: 73%
              opacity: 0
              '--mdc-icon-size': 209px
              transform: 'scaleX(0.85) scaleY(1.1)'
          # Office
          - type: icon
            icon: mdi:selection
            entity: input_boolean.floorplan_office_selected
            tap_action:
              action: toggle
            style:
              left: 37%
              top: 75%
              opacity: 0
              '--mdc-icon-size': 170px
              transform: 'scaleX(0.75) scaleY(1.3)'
          # Guest
          - type: icon
            icon: mdi:selection
            entity: input_boolean.floorplan_guest_selected
            tap_action:
              action: toggle
            style:
              left: 61%
              top: 74%
              opacity: 0
              '--mdc-icon-size': 190px
              transform: 'scaleX(0.7) scaleY(1.2)'
          # Kitchen
          - type: icon
            icon: mdi:selection
            entity: input_boolean.floorplan_kitchen_selected
            tap_action:
              action: toggle
            style:
              left: 53.3%
              top: 10%
              opacity: 0
              '--mdc-icon-size': 177px
              transform: 'scaleX(1) scaleY(1.2)'
          # Living room
          - type: icon
            icon: mdi:selection
            entity: input_boolean.floorplan_living_selected
            tap_action:
              action: toggle
            style:
              left: 5%
              top: 24%
              opacity: 0
              '--mdc-icon-size': 250px
              transform: 'scaleX(0.9) scaleY(2.03)'
          
        # #####################################################################
        # SELECT ROOMS: CLICKABLE ZONES, OUTLINES & OVERLAYS
        - type: conditional
          conditions:
            - entity: input_boolean.select_rooms_cleaning
              state: "off"
          elements:
          # SELECTED ROOM OUTLINE
          - type: image
            entity: input_select.floorplan_select_state
            state_image:
              "bath": "/local/floorplan/outline-v2-bath.png"
              "bedroom": "/local/floorplan/outline-v2-bedroom.png"
              "entry": "/local/floorplan/outline-v2-entry.png"
              "guest": "/local/floorplan/outline-v2-guest.png"
              "kitchen": "/local/floorplan/outline-v2-kitchen.png"
              "living": "/local/floorplan/outline-v2-living.png"
              "office": "/local/floorplan/outline-v2-office.png"
              "storage": "/local/floorplan/outline-v2-storage.png"
              "toilet": "/local/floorplan/outline-v2-toilet.png"
              "veranda": "/local/floorplan/outline-v2-veranda.png"
              "none": "/local/floorplan/base-empty.png"
            style:
              left: 50%
              top: 50%
              width: 100%
              filter: hue-rotate(199deg)
            tap_action:
              action: none
            hold_action:
              action: none
          # SELECTED ROOM OVERLAY
          - type: image
            entity: input_select.floorplan_select_state
            state_image:
              "bath": "/local/floorplan/overlay-bath.png"
              "bedroom": "/local/floorplan/overlay-bedroom.png"
              "entry": "/local/floorplan/overlay-entry.png"
              "guest": "/local/floorplan/overlay-guest.png"
              "kitchen": "/local/floorplan/overlay-kitchen.png"
              "living": "/local/floorplan/overlay-living2.png"
              "office": "/local/floorplan/overlay-office.png"
              "storage": "/local/floorplan/overlay-storage.png"
              "toilet": "/local/floorplan/overlay-toilet.png"
              "veranda": "/local/floorplan/overlay-veranda.png"
              "none": "/local/floorplan/base-empty.png"
            style:
              left: 50%
              top: 50%
              width: 100%
              filter: hue-rotate(199deg)
              opacity: 20%
            tap_action:
              action: none
            hold_action:
              action: none
          # CLICKABLE ZONES AS HIDDEN ICONS
          # Veranda
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: veranda
            style:
              left: 34.5%
              top: 0%
              opacity: 0
              '--mdc-icon-size': 65px
              transform: 'scaleX(4.5) scaleY(1)'
          # Storage
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: storage
            style:
              left: 73.2%
              top: 0%
              opacity: 0
              '--mdc-icon-size': 66px
              transform: 'scaleX(1.3) scaleY(1)'
          # Kitchen
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: kitchen
            style:
              left: 53.3%
              top: 10%
              opacity: 0
              '--mdc-icon-size': 177px
              transform: 'scaleX(1) scaleY(1.2)'
          # Living room
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: living
            style:
              left: 5%
              top: 24%
              opacity: 0
              '--mdc-icon-size': 250px
              transform: 'scaleX(0.9) scaleY(2.03)'
          # Bath
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: bath
            style:
              left: 53%
              top: 34%
              opacity: 0
              '--mdc-icon-size': 185px
              transform: 'scaleX(1) scaleY(1)'
          # Toilet
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: toilet
            style:
              left: 76.5%
              top: 46.75%
              opacity: 0
              '--mdc-icon-size': 80px
              transform: 'scaleX(1) scaleY(1.15)'
          # Entry
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: entry
            style:
              left: 61%
              top: 57%
              opacity: 0
              '--mdc-icon-size': 120px
              transform: 'scaleX(1.6) scaleY(1)'
          # Bedroom
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: bedroom
            style:
              left: 2%
              top: 73%
              opacity: 0
              '--mdc-icon-size': 209px
              transform: 'scaleX(0.85) scaleY(1.1)'
          # Office
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: office
            style:
              left: 37%
              top: 75%
              opacity: 0
              '--mdc-icon-size': 170px
              transform: 'scaleX(0.75) scaleY(1.3)'
          # Guest
          - type: icon
            icon: mdi:selection
            tap_action:
              action: call-service
              service: script.select_floorplan_room
              data:
                room_name: guest
            style:
              left: 61%
              top: 74%
              opacity: 0
              '--mdc-icon-size': 190px
              transform: 'scaleX(0.7) scaleY(1.2)'

        # #####################################################################
        # HIDE ICON / LAYERS + UNSELECT ICON
        - type: conditional
          conditions:
            - entity: input_select.floorplan_select_state
              state_not: "none"
          elements:
            - type: icon
              icon: mdi:window-close
              tap_action:
                action: call-service
                service: script.deselect_floorplan_room
              hold_action:
                action: none
              style:
                left: 94%
                top: 7%
                color: '#03A9F4'
                '--mdc-icon-size': 30px
            - type: icon
              icon: mdi:selection
              tap_action:
                action: call-service
                service: script.deselect_floorplan_room
              style:
                left: 0%
                top: 46%
                opacity: 0
                color: white
                '--mdc-icon-size': 100px
                transform: 'scaleX(1) scaleY(8.3)'
            - type: icon
              icon: mdi:selection
              tap_action:
                action: call-service
                service: script.deselect_floorplan_room
              style:
                left: 88%
                top: 42%
                opacity: 0
                color: white
                '--mdc-icon-size': 135px
                transform: 'scaleX(1) scaleY(6.3)'
        - type: conditional
          conditions:
            - entity: input_boolean.floorplan_show_icons
              state: "on"
          elements:
            - type: state-icon
              entity: input_boolean.floorplan_show_icons
              icon: mdi:eye
              tap_action:
                action: toggle
              hold_action:
                action: none
              style:
                left: 94%
                top: 2%
                color: white
                '--mdc-icon-size': 30px
                '--state-active-color': white
        - type: conditional
          conditions:
            - entity: input_boolean.floorplan_show_icons
              state: "off"
          elements:
            - type: state-icon
              entity: input_boolean.floorplan_show_icons
              icon: mdi:eye-off
              tap_action:
                action: toggle
              hold_action:
                action: none
              style:
                left: 94%
                top: 2%
                '--mdc-icon-size': 30px
        
        # ###########################################################
        # DEVICE ICONS
        - type: conditional
          conditions:
            - entity: input_boolean.floorplan_show_icons
              state: "on"
          elements:
            # BEDROOM PENDANT ICON
            - type: custom:button-card
              template: light
              entity: light.pendant_bedroom
              style:
                left: 27%
                top: 80%
            # OFFICE PENDANTS ICON
            - type: custom:button-card
              entity: light.pendants_office
              template: light
              style:
                left: 54%
                top: 80%
            # OFFICE HEATER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              entity: climate.heater_office
              template: heat_device
              style:
                  left: 60%
                  top: 97%
            # BEDROOM HEATED SHEET ICON (ONLY DISPLAYS WHEN ON)
            # COMMENTED OUT DUE TO OUT OF SEASON - DEVICE DISABLED
            - type: custom:button-card
              entity: switch.plug_seasonal_heat
              template: heat_device
              style:
                  left: 31%
                  top: 86%
            # BEDROOM HEATER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              entity: climate.heater_bedroom
              template: heat_device
              style:
                  left: 23%
                  top: 97%
            # BEDROOM SONOS SPEAKER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              template: speaker_device
              entity: media_player.sonos_bedroom
              style:
                left: 10%
                top: 91%
            # GUEST PENDANT ICON
            - type: custom:button-card
              template: light
              entity: light.pendant_guest
              style:
                left: 75%
                top: 80%
            # GUEST HEATER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              entity: climate.heater_guest
              template: heat_device
              style:
                left: 75%
                top: 97%
            # ENTRY DOWNLIGHTS ICON
            - type: custom:button-card
              template: light
              entity: light.downlights_entry
              style:
                left: 71.75%
                top: 64%
            # TOILET DOWNLIGHT ICON
            - type: custom:button-card
              template: light
              entity: light.downlight_toilet
              style:
                left: 85%
                top: 52%
            # BATH SONOS SPEAKER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              template: speaker_device
              entity: media_player.sonos_move
              style:
                left: 60%
                top: 38%
            # BATH DOWNLIGHTS ICON
            - type: custom:button-card
              template: light
              entity: light.downlights_bath
              style:
                left: 64%
                top: 54%
            # BATH LIGHTSTRIP ICON
            - type: custom:button-card
              template: light
              entity: light.lightstrip_bath
              styles:
                icon:
                  - transform: rotate(45deg)
              style:
                left: 89%
                top: 41%
            # BATH FLOOR HEAT ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              entity: climate.floor_heat_bath
              template: heat_device
              style:
                left: 64%
                top: 47%
            # LIVING ROOM SPOTTRACK ICON
            - type: custom:button-card
              template: light
              entity: light.spottrack4_living
              style:
                left: 41%
                top: 44%
            # LIVING ROOM DOWNLIGHTS ICON
            - type: custom:button-card
              template: light
              entity: light.downlights_living
              style:
                left: 14%
                top: 45%
            # LIVING ROOM MUSHROOM LAMP
            - type: custom:button-card
              template: light
              entity: switch.lamp_mushroom_living
              style:
                left: 50%
                top: 51%
            # LIVING ROOM MOOD BALL
            - type: custom:button-card
              template: light
              entity: light.mood_lamp_living
              style:
                left: 50%
                top: 38%
            # LIVING ROOM GLOBE LAMP
            - type: custom:button-card
              template: light
              entity: switch.lamp_globe_living
              style:
                left: 18%
                top: 67%
            # LIVING ROOM SONOS SPEAKER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              template: speaker_device
              entity: media_player.sonos_living
              style:
                left: 50%
                top: 44.5%
            # LIVING ROOM HEATER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              entity: climate.heater_living
              template: heat_device
              style:
                left: 17%
                top: 28%
            # LIVING ROOM PENDANTS ICON (DINING TABLE)
            - type: custom:button-card
              template: light
              entity: light.pendants_living
              style:
                left: 34.5%
                top: 20%
            # LIVING ROOM CURTAINS - MOVE LEFT
            # "Close"
            - type: custom:button-card
              entity: cover.curtain_living
              icon: mdi:arrow-left-thin
              template:
                - icon_main
              show_name: false
              size: 75%
              tap_action:
                action: call-service
                service: |
                  [[[
                    if (entity.state === 'closing') return 'cover.stop_cover';
                    return 'cover.close_cover';
                  ]]]
                target:
                  entity_id: cover.curtain_living
                haptic: medium
              hold_action:
                action: more-info
              styles:
                card:
                  - width: 32px
                  - height: 32px
                  - border-radius: 18px
                  - background-color: |
                      [[[
                        if (entity.state === 'closing') return 'rgba(255, 255, 255, 1.0)';
                        return 'rgba(115, 115, 115, 0.6)'; 
                      ]]]
                icon:
                  - color: |
                      [[[
                        if (entity.state === 'closing') return 'var(--color-primary)';
                        return 'rgba(255, 255, 255, 1.0)'; 
                      ]]]
              style:
                left: 20%
                top: 11%
            # LIVING ROOM CURTAINS - MOVE RIGHT
            # "Open"
            - type: custom:button-card
              entity: cover.curtain_living
              icon: mdi:arrow-right-thin
              template:
                - icon_main
              show_name: false
              size: 75%
              tap_action:
                action: call-service
                service: |
                  [[[
                    if (entity.state === 'opening') return 'cover.stop_cover';
                    return 'cover.open_cover';
                  ]]] 
                target:
                  entity_id: cover.curtain_living
                haptic: medium
              hold_action:
                action: more-info
              styles:
                card:
                  - width: 32px
                  - height: 32px
                  - border-radius: 18px
                  - background-color: |
                      [[[
                        if (entity.state === 'opening') return 'rgba(255, 255, 255, 1.0)';
                        return 'rgba(115, 115, 115, 0.6)'; 
                      ]]]
                icon:
                  - color: |
                      [[[
                        if (entity.state === 'opening') return 'var(--color-primary)';
                        return 'rgba(255, 255, 255, 1.0)'; 
                      ]]]
              style:
                left: 20%
                top: 15%
            # KITCHEN SONOS SPEAKER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              template: speaker_device
              entity: media_player.sonos_kitchen
              style:
                left: 86.5%
                top: 14%
            # KITCHEN PENDANTS ICON
            - type: custom:button-card
              template: light
              entity: light.pendants_kitchen
              style:
                left: 61%
                top: 20%
            # KITCHEN SPOTTRACK ICON
            - type: custom:button-card
              template: light
              entity: light.spottrack6_kitchen
              style:
                left: 74%
                top: 20%
            # KITCHEN LIGHTSTRIP UNDER-SHELF
            - type: custom:button-card
              template: light
              entity: light.lightstrip_undershelf_kitchen
              styles:
                icon:
                  - transform: rotate(45deg)
              style:
                left: 86.5%
                top: 32%
            # KITCHEN HEATER ICON (ONLY DISPLAYS WHEN ON)
            - type: custom:button-card
              entity: climate.heater_kitchen
              template: heat_device
              style:
                left: 61%
                top: 14%
            # VERANDA WALL LANTERN
            - type: custom:button-card
              template: light
              entity: light.wall_light_veranda
              style:
                left: 53.5%
                top: 6.5%   
    # ----------------------------------------------- END OF 3D FLOORPLAN